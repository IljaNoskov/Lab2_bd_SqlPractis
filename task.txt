ВАРИАНТ 4
Уровень 1
МЕДПЕРСОНАЛ
ИДЕНТИФИКАТОР ФАМИЛИЯ АДРЕС НАЛОГ,%
МЕСТО РАБОТЫ
ИДЕНТИФИКАТОР УЧРЕЖДЕНИЕ АДРЕС ОТЧИСЛЕНИЕ В МЕСТНЫЙ БЮДЖЕТ, %
ТИПЫ ОПЕРАЦИЙ
ИДЕНТИФИКАТОР НАИМЕНОВАНИЕ ОПОРНЫЙ ПУНКТ ЗАПАСЫ СТОИМОСТЬ, РУБ
ТРУДОВАЯ ДЕЯТЕЛЬНОСТЬ
ДОГОВОР ДАТА МЕД
ПЕРСОНАЛ
МЕСТО РАБОТЫ ОПЕРАЦИИ КОЛ-ВО ОПЛАТА, РУБ
Дана схема базы данных в виде следующих отношений. С помощью операторов SQL
создать логическую структуру соответствующих таблиц для хранения в СУБД,
используя известные средства поддержания целостности (NOT NULL, UNIQUE, и т.д.).
Обосновать выбор типов данных и используемые средства поддержания целостности.
При выборе подходящих типов данных использовать информацию о конкретных
значениях полей БД (см. прил.1)
1.
Ввести в ранее созданные таблицы конкретные данные (см. прил. 1). Использовать
скрипт-файл из операторов INSERT или вспомогательную утилиту .
2.
Используя оператор SELECT создать запрос для вывода всех строк каждой таблицы.
Проверить правильность ввода. При необходимости произвести коррекцию значений
операторами INSERT, UPDATE, DELETE.
3.
4. Вывести с помощью запросов:
c) различные адреса всех медработников;
d) список всех различных медучреждений;
e) различные дни, для которых хранится информация о трудовой деятельности.
5. Найти:
даты и номера договоров, когда производились операции на сумму не менее
14000руб.
c)
d) размер налога для медперсонала из Выксы или Навашино;
название, стоимость и адрес опорного пункта для операций, в названии которых есть
слово “Инъекция”, и стоящих более 10000руб. Результат отсортировать по адресу и
стоимости.
e)
На основании данных о проведенных операциях вывести в следующем формате все
записи:
6.
c) дата, фамилия медперсонала, название места работы, название операции;
номер договора, название места работы, количество операций, оплата.
Отсортировать по возрастанию оплаты.
d)
7. Определить:
фамилии и места проживания медперсонала, проведших более одного наложения
гипса в день;
c)
название операций, которые проводили врачи из Вознесенского или Выксы в
больницах;
d)
названия и размер отчислений в местный бюджет для тех учреждений, где
проводили операции те, у кого налог не менее 7%, но не более 16%. Включить в
вывод фамилии таких людей и отсортировать по размеру отчислений и налогу;
e)
Уровень 2
даты, идентификаторы операций и фамилии тех, кто проводил операции стоимостью
не менее 7000руб больше одного раза.
a)
Создать запрос для модификации всех значений столбца с суммарной величиной
оплаты, чтобы он содержал истинную сумму, получаемую медперсоналом ( за вычетом
налога). Вывести новые значения.
8.
Расширить таблицу с данными об операциях столбцом, содержащим величину
отчислений в местный бюджет для мед.учреждения, где проводилась операция. Создать
запрос для ввода конкретных значений во все строки таблицы операций.
9.
10. Используя операцию IN (NOT IN) реализовать следующие запросы:
c) найти фамилии медперсонала из Навашино, проводивших инъекции в Выксе;
d) найти те операции, которые не проводились до среды;
e) запросы задания 7.с и 7.d.
11. Используя операции ALL-ANY реализовать следующие запросы:
c) найти среди больниц ту, которая имеет наименьший процент отчислений;
d) найти педперсонал, проводивший операции с самой малой суммой оплаты;
e) найти цену самой дорогой операции, проведенной в четверг или пятницу;
f) запрос задания 7.а.
Используя операцию UNION получить места проживания медпероснала и опероные
пункты для операций.
12.
Используя операцию EXISTS ( NOT EXISTS ) реализовать нижеследующие запросы. В
случае, если для текущего состояния БД запрос будет выдавать пустое множество
строк, требуется указать какие добавления в БД необходимо провести.
13.
c) определить тот медперсонал, который не работал в субботу;
d) найти такие операции, которые проводились всеми врачами в Выксе;
e) определить те места работы, где не делали УЗИ более раза;
f) определить места работы, где работали все врачи из чужих населенных пунктов.
14. Реализовать запросы с использованием аггрегатных функций:
найти число различных мест работы для медперсонала, работавшего в
мед.учреждениях Выксы;
c)
d) определить средний размер налога для медперсонала, производившего иньекции;
e) кто из медперсонала делал операцию с минимальной стоимостью;
определить количество операций стоимостью не более 15000, проведенных в
понедельник Губановым .
f)
15. Используя средства группировки реализовать следующие запросы:
c) определить для каждого дня недели и каждой операции сколько раз ее проводили;
найти для каждого медработника среднюю стоимость всех проведенных им
операций;
d)
определить те мед.учреждения, где суммарная величина стоимости всех
проведенных в них операций была более 30000;
e)
f) для каждого дня недели найти число проведенных в этот день операций.
